
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Java工厂模式切换数据库 - Java - 金龙博客</title>
<meta name="description" content="前二天，在struts介绍的实例中就提到数据库的访问使用了工厂模式，可以实现在线切换数据库的功能，同样是那个NetBeans工程，今天就来具体介绍我实现的思路。
网上有很多工厂模式的介绍，我最先接触是在.Net的PetShop项目里看到的，最近公司要搞Java，所以就搬到Java里来运用下，看了一些资料好象我这种实现的方法叫做简单工厂，是通过定义接口来实现的，在面向对象编程的世界里面，接口用来定义的一组规范，它强制规范实现类要一定要实现完成它的所有成员，至于接口的调用到底使用那个实现类则是在工厂类里面产生的。接口一般多定义对象的行为动作即方法，而抽象类则多用来定义对象的公共属性，比如男人和女人可以抽象出人做为抽象基类，因为都有人的一些公共特征，至于什么时候用接口什么时候用抽象类，这个就需要看实际项目中对象的关系了。
还是用户的增删改查功能的实现为例子，我们先需要定义用户的接口IUser，然后使用不同数据库来分别实现它，程序使用那种数据库则放在properties资源文件里配置，工厂在根据配置产生实例类，以接口形式返回到业务逻辑层，然后在页面里调用业务逻辑层方法。这里我用PowerDesiger简单画了一个类图如下..." />
<link href="/styles/index/css/default/index.css" id="linkIndex" rel="stylesheet" type="text/css" />
<link href="/styles/index/css/default/template2.css" id="linkTemplate" rel="stylesheet" type="text/css" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script type="text/javascript" src="/styles/index/scripts/ajax.js"></script>
</head>
<body>
<div id="toolbar">
	<div class="auto fixft" >
	    <a href="/" class="home"><span>首页</span><img alt="logo" src="/styles/index/css/default/images/logo_small.gif" /></a>
		
		<!--<form id="loginFrom" name="loginFrom" onsubmit="return loginEncrypt();" action="/User/Login.aspx"  method="post" target="loginIfr">
		    <input type="hidden" id="hdEncrypted" name="hdEncrypted" value="" />
		    <div class="login">
			    <span class="ico">用户名：</span>
			    <input id="username" name="username" onfocus="loadEncryptScript()" class="text" type="text" />
			    密码：<input id="password" name="password" onfocus="loadEncryptScript()" class="text" type="password" />
			    <input id="btnLogin" class="btn" type="submit" value="登录" />
			    
			    <a href="#" onclick="location='https://localhost/Passport';" >安全登录</a>
			    
		    </div>
		</form>
		<iframe id="loginIfr" name="loginIfr" scrolling="no" frameborder="0" width="0" height="0"></iframe>
        <script type="text/javascript">
            function loadEncryptScript(){
                if( typeof(encryptScript) == 'undefined') {
                    
                    document.getElementById('btnLogin').disabled = true;
                    
                    encryptScript = document.createElement('script');
                    encryptScript.type = 'text/javascript';
                    encryptScript.src = '/Ajax/RSAEncrypt.aspx?callback=loadEncryptScriptCallback';
                    var currScriptElem = document.getElementsByTagName('script')[0];
                    currScriptElem.parentNode.insertBefore(encryptScript, currScriptElem);
                }
            }
            function loadEncryptScriptCallback(){
                document.getElementById('btnLogin').disabled = false;
            }
            function loginEncrypt(){
                
                var pwdElem = document.getElementById('password');
                var encryptedPassword = RSAEncrypt(pwdElem.value);
                pwdElem.value = encryptedPassword;
                document.getElementById('hdEncrypted').value = 'RSA';
                return true;
            }
        </script>-->
		
		<div class="skin">
			<ul id="skinlist">
			    <li class="first">　切换风格：</li>
			    <li id="temp2" class="on"><a class="green" href="javascript:toggleTemplate(2, '/styles/index/css/default/index.css', false);"  title="切换风格：大自然绿">大自然绿</a></li><li id="temp3" class=""><a class="blue" href="javascript:toggleTemplate(3, '/styles/index/css/blue/index.css', false);"  title="切换风格：深蓝海">深蓝海</a></li><li id="temp4" class=""><a class="red" href="javascript:toggleTemplate(4, '/styles/index/css/guoqing/index.css', false);"  title="切换风格：国庆专题">国庆专题</a></li><li id="temp6" class=""><a class="christmas" href="javascript:toggleTemplate(6, '/styles/index/css/christmas/index.css', false);"  title="切换风格：圣诞节">圣诞节</a></li><li id="temp7" class=""><a class="simple" href="javascript:toggleTemplate(7, '/styles/index/css/simple/index.css', false);"  title="切换风格：简单线条">简单线条</a></li>
			</ul>
		</div>
		<div class="display">
		    <ul>
		        <li>　<!--版面：--></li>
		        <!--<li><a href="#" onclick="location='?display=1';" class="">左-中</a> | </li>
		        <li><a href="#" onclick="location='?display=2';" class="on">左-中-右</a> | </li>
		        <li><a href="#" onclick="location='?display=3';" class="">中-右</a> | </li>
		        <li><a href="#" onclick="location='?display=4';" class="">中</a></li>-->
		    </ul>
		</div>
	</div>
</div>
<div class="auto" id="top" style="" >
	<div class="title">
	    <h3>jonllen</h3>
	    <h4>金龙，目前就职于一家软件公司，从事Java和.Net信息安全开发设计。
</h4>
	</div>
</div>
<div class="auto" id="nav" >
	<ul id="navigation">
		<li><a href="/">首页</a></li>
        <li><a href="/jonllen/aspnet/" class="up" >Asp.Net</a></li>
<li><a href="/jonllen/work/"  >工作</a></li>
		<li><a class="up" href="/album/">相册</a></li>
		<li><a href="/leave/"><!--留言--></a></li>
		<li class="preview"></li>
	</ul>
</div>
<script type="text/javascript"> 
(function (){
    var select, navlist = document.getElementById('navigation').getElementsByTagName('li');
    for(var i=0;i<navlist.length;i++)
    {
        if ( navlist[i].className=='preview') continue;
        var link = navlist[i].getElementsByTagName('a')[0];
        if ( link && window.location.href.toLowerCase().indexOf(link.href.toLowerCase())>-1 )
        {
            select = link;
        }
    }
    if( select!=undefined )
    {
        select.parentNode.className = "on";
    }
})();
function toggleTemplate(tempId, skinSrc, additionalHtml){
    if( additionalHtml) {
        location='?tempid='+tempId;
        return true;
    }
    
    var linkIndexElem = document.getElementById('linkIndex');
    var linkIndexHref = '' + skinSrc;
    linkIndexElem.href = '';
    linkIndexElem.href = linkIndexHref;
    
    var linkTemplateElem = document.getElementById('linkTemplate');
    var linkTemplateHref = linkIndexHref.substr(0, linkIndexHref.lastIndexOf('/') ) + linkTemplateElem.href.substr(linkTemplateElem.href.lastIndexOf('/'));
    linkTemplateElem.href = '';
    linkTemplateElem.href = linkTemplateHref;
    
    var skinName = 'Skin';
    var skinValue = '0='+tempId;
    var skinDate = new Date();
    skinDate.setTime(skinDate.getTime() + 1000 * 60 * 120 );
    document.cookie = skinName + '=' + skinValue + '; path=/; expires=' + skinDate.toGMTString();
    
    var templatelist = document.getElementById('skinlist').getElementsByTagName('li');
    for(var i=0;i<templatelist.length;i++){
        var templateli = templatelist[i];
        if (templateli.className == 'on')
            templateli.className = '';
        if( templateli.id == 'temp' + tempId)
            templateli.className = 'on';
    }
}
</script>

<div id="main" class="auto container">
    <div id="ctl00_panLeft" class="siderLeft column column1">
	
<div id="mod25" class="mod info">
	<div class="head"><strong class="ico">个人档案</strong></div>
	<div class="cont">
		<dl>
			<dt><a href="/jonllen/"><img src="/upload/jonllen/upload/wolf.gif" defaultsrc="/styles/index/css/default/images/ico_default.gif" onerror="if(this.src.indexOf(this.getAttribute('defaultsrc'))==-1) this.src=this.getAttribute('defaultsrc');" /><br />jonllen</a></dt>
			<dd><a href="/breast/" class="profile">心情闪存</a> | <a href="/leave/" class="article">给他留言</a></dd>
			<!--<dd><a href="/rss.aspx" target="_blank" class="rss">RSS网志</a> | <a href="/profile.aspx" class="">个人档案</a></dd>-->
			<dd>妮称：jonllen</dd>
			<dd>来自：中国. 湖南. 湘潭</dd>
			<dd>简述：金龙，目前就职于一家软件公司，从事Java和.Net信息安全开发设计。
</dd>
		</dl>
	</div>
</div>
<div id="mod26" class="mod calendar">
	<div class="head"><strong class="ico">博客日历</strong></div>
	<div id="calendar" class="cont"></div>
	<script type="text/javascript" language="javascript" src="/styles/index/scripts/DatePicker/WdatePicker.js" ></script>
    <script type="text/javascript" language="javascript">
        function ePicked(dp)
        {
            for(var i=0;i<archive.length;i++)
            {
                //if(archive[i]==dp.cal.getDateStr())
                    //window.location = '/archive/' + dp.cal.getDateStr() + '.aspx';
            }
        }
        
            function getArticleArchive()
		    {
		        var url = "/plugin/web/getArticleArchive.do?coluidpath=500&colutype=1";		        		        
		        Ajax.send({
		            type : "GET",
		            url : url,
		            fn : function (data){
	                    var rs;
	                    try{rs=eval("rs="+data);}catch(e){alert(e);return;}
                        
	                    if (rs.success)
	                    {
	                        var archive = [];
	                        if(rs.data) archive = rs.data.split(',');
	                        window.archive = archive;
	                        WdatePicker( { eCont :'calendar', firstDayOfWeek :1, specialDates :archive.length > 0 ? archive : null, onpicked :ePicked, startDate:'2009-10-23' } );
 	                    }else
	                    {
	                        alert(rs.error);
	                    }
                            }
		        });
		    }
        setTimeout(getArticleArchive,0);
    </script>
</div>
<div id="mod27" class="mod category">
	<div class="head"><strong class="ico">分类文档</strong></div>
	<div class="cont">
		<ul>

			
			        <li>
			            
			            <a href="/jonllen/reflection/" >
			                三日必省吾身<!-- (0)-->
			            </a>
			        </li>
			
			        <li>
			            
			            <a href="/jonllen/remark/" >
			                备忘录<!-- (0)-->
			            </a>
			        </li>
			
			        <li>
			            
			            <a href="/jonllen/it/" >
			                业界<!-- (0)-->
			            </a>
			        </li>
			
			        <li>
			            
			            <a href="/jonllen/css/" >
			                CSS<!-- (0)-->
			            </a>
			        </li>
			
			        <li>
			            
			            <a href="/jonllen/flex/" >
			                Flex<!-- (0)-->
			            </a>
			        </li>
			
			        <li>
			            
			            <a href="/jonllen/db/" >
			                数据库<!-- (0)-->
			            </a>
			        </li>
			
			        <li>
			            
			            <a href="/jonllen/java/" >
			                Java<!-- (0)-->
			            </a>
			        </li>
			
			        <li>
			            
			            <a href="/jonllen/work/" >
			                工作<!-- (0)-->
			            </a>
			        </li>
			
			        <li>
			            
			            <a href="/jonllen/breast/" >
			                心情笔记<!-- (0)-->
			            </a>
			        </li>
			
			        <li>
			            
			            <a href="/jonllen/aspnet/" >
			                Asp.Net<!-- (0)-->
			            </a>
			        </li>
			
			        <li>
			            
			            <a href="/jonllen/js/" >
			                JavaScript<!-- (0)-->
			            </a>
			        </li>
			
			        <li>
			            
			            <a href="/jonllen/album/" >
			                我的相册<!-- (0)-->
			            </a>
			        </li>
			
			        <li>
			            
			            <a href="/jonllen/travel/" >
			                旅游<!-- (0)-->
			            </a>
			        </li>
			
		</ul>
	</div>
</div>
 
<!--<div id="mod28" class="mod links">
	<div class="head"><strong class="ico">友情链接</strong></div>
	<div class="cont">
		<ul>
                    
		    <li><a href="http://www.applezqp.com" title="老平同志，高妹。" target="_blank">applezqp</a></li>
                    
		    <li><a href="http://www.thjy.org" title="天河部落教育博客" target="_blank">天河部落</a></li>
                    
		    <li><a href="http://weibo.com/zjj" title="时代财富张静君的微博" target="_blank">张静君</a></li>
                    
		    <li><a href="http://www.fortuneage.com" title="广州网站建设" target="_blank">时代财富</a></li>
                    
		</ul>
	</div>
</div>-->
 
</div>

	<div class="siderMiddle">
	    <div class="content column column2">
            

    <div class="articlecont">
        <div class="position">
		    <strong>当前位置：</strong>
		    <a href="http://localhost:8080">首页</a>
		     > <a href="/jonllen/java/">Java</a>
		     > <a href="/jonllen/java/78.html">Java工厂模式切换数据库</a>
		</div>
        <div class="article">
			<div class="title"><h2>Java工厂模式切换数据库</h2></div>
			<div class="category">分类：<a href="/jonllen/java/">Java</a></div>
			<div class="fontZoom"><a href="javascript:zoom(20);" style="font-size:large; font-weight:700">大</a><a href="javascript:zoom(14);" style="font-size:14px; font-weight:500;">中</a><a href="javascript:zoom(10);">小</a></div>
			<div class="cont" id="content">
				<div style="font-size: 14px; line-height: 30px;">
<p style="text-indent: 2em;">前二天，在struts介绍的实例中就提到数据库的访问使用了工厂模式，可以实现在线切换数据库的功能，同样是那个NetBeans工程，今天就来具体介绍我实现的思路。</p>
<p style="text-indent: 2em;">网上有很多工厂模式的介绍，我最先接触是在.Net的PetShop项目里看到的，最近公司要搞Java，所以就搬到Java里来运用下，看了一些资料好象我这种实现的方法叫做简单工厂，是通过定义接口来实现的，在面向对象编程的世界里面，接口用来定义的一组规范，它强制规范实现类要一定要实现完成它的所有成员，至于接口的调用到底使用那个实现类则是在工厂类里面产生的。接口一般多定义对象的行为动作即方法，而抽象类则多用来定义对象的公共属性，比如男人和女人可以抽象出人做为抽象基类，因为都有人的一些公共特征，至于什么时候用接口什么时候用抽象类，这个就需要看实际项目中对象的关系了。</p>
<p style="text-indent: 2em;">还是用户的增删改查功能的实现为例子，我们先需要定义用户的接口IUser，然后使用不同数据库来分别实现它，程序使用那种数据库则放在properties资源文件里配置，工厂在根据配置产生实例类，以接口形式返回到业务逻辑层，然后在页面里调用业务逻辑层方法。这里我用PowerDesiger简单画了一个类图如下：</p>
<p><a href="/upload/jonllen/article/factory.gif" target="_blank"><img src="/upload/jonllen/article/factory.gif" alt="Java工厂模式类图" width="500" height="432" /></a></p>
<p style="text-indent: 2em;">首先我们来看一下IUser接口类的代码：</p>
<pre><div class="code"><div><span style="color: #0000ff;">package</span><span style="color: #000000;"> dal;<br /><br /></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> bean.User;<br /></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;<br /><br /></span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">interface</span><span style="color: #000000;"> IUser {<br /><br />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> UserAdd(User user);<br /><br />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> UserDel(</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> id);<br /><br />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> UserUpdate(User user);<br /><br />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> User GetUserInfo(</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> id);<br /><br />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> List</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">User</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> GetUserList();<br />}</span></div></div></pre>
<p style="text-indent: 2em;">代码比较简单，就是定义用户业务逻辑所需要的全部方法，然后在子类里将会被一一实现。接口里增加一个方法，所有子类都必须要提供该方法的实现，不然会编译不过，这也是使用接口的一个规范问题。这里需要注意的是.Net里所有接口成员都不需要加访问修饰符，默认为public，而java则可以加public，如果接口里有字段属性则需要赋初始值，在调用的是以static final成员的形式来调用的。</p>
<p style="text-indent: 2em;">我们再看一下DataAccess工厂代码：</p>
<pre><div class="code"><div><!--<br /><br />Code highlighting produced by Actipro CodeHighlighter (freeware)<br />http://www.CodeHighlighter.com/<br /><br />--><span style="color: #008000;">/*</span><span style="color: #008000;"><br /> * 数据库访问工厂<br /> </span><span style="color: #008000;">*/</span><span style="color: #000000;"><br /><br /></span><span style="color: #0000ff;">package</span><span style="color: #000000;"> dal;<br /><br /></span><span style="color: #008000;">/**</span><span style="color: #008000;"><br /> *<br /> * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> Jonllen<br /> * @create 2009-05-18 22:04:42<br /> * @site   </span>http://www.jonllen.com<span style="color: #008000;"><br /> </span><span style="color: #008000;">*/</span><span style="color: #000000;"><br /></span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> DataAccess {<br /><br />    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> DataAccess(){}<br />    <br />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> String daoPackageName </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.DbManager.GetConfig().getDefaultItem().getPackageName();<br /><br />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> Object InstanceObject(String className)<br />    {<br />        String classPath </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #000000;">"</span><span style="color: #000000;">dao.</span><span style="color: #000000;">"</span><span style="color: #000000;"> </span><span style="color: #000000;"> </span><span style="color: #000000;"> daoPackageName </span><span style="color: #000000;"> </span><span style="color: #000000;"> </span><span style="color: #000000;">"</span><span style="color: #000000;">.</span><span style="color: #000000;">"</span><span style="color: #000000;"> </span><span style="color: #000000;"> </span><span style="color: #000000;"> className;<br />        </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {<br />            System.out.println(</span><span style="color: #000000;">"</span><span style="color: #000000;">--实例化</span><span style="color: #000000;">"</span><span style="color: #000000;"> </span><span style="color: #000000;">classPath</span><span style="color: #000000;"> </span><span style="color: #000000;">"</span><span style="color: #000000;">类开始--</span><span style="color: #000000;">"</span><span style="color: #000000;">);<br />            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> Class.forName(classPath).newInstance();<br />        } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception ex) {<br />            System.out.println(</span><span style="color: #000000;">"</span><span style="color: #000000;">**实例化</span><span style="color: #000000;">"</span><span style="color: #000000;"> </span><span style="color: #000000;">classPath</span><span style="color: #000000;"> </span><span style="color: #000000;">"</span><span style="color: #000000;">类失败**</span><span style="color: #000000;">"</span><span style="color: #000000;">);<br />            ex.printStackTrace();<br />        }<br />        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> </span><span style="color: #0000ff;">null</span><span style="color: #000000;">;<br />    }<br /><br />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> IUser CreateUser()<br />    {<br />        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> (IUser)InstanceObject(</span><span style="color: #000000;">"</span><span style="color: #000000;">UserDAO</span><span style="color: #000000;">"</span><span style="color: #000000;">);<br />    }<br /><br />}</span></div></div></pre>
<p style="text-indent: 2em;">首先这个工厂类里面全是静态的成员，而且构造函数是private级别的，这其实是Java里单例的一种，为确保全局只存在一个实例。这里的daoPackageName是当前访问数据库类的包名，相当与.Net里的命名空间，我在程序里面做为一个约定，就是所有操作访问数据库的全部放在dao包下面，然后下面不同的数据库创建不同的包名，每个包下面的类名一样，这样我们根据不同数据库的包名就能创建下面类的事例，在.Net里我们使用Assembly.Load("命名空间").CreateInstance("类名全路径")程序集动态创建类的实例，而在Java里面使用Class.forName("类名全路径").newInstance()，再将Object类型强转为接口，因为这些类是实现了对应的业务接口的。在这里我推荐使用以上InstanceObject方法这种命名约定来动态创建类实例，而不要根据daoPackageName包名判断去new一个事例，如下代码是不妥的：</p>
<pre><div class="code"><div><!--<br /><br />Code highlighting produced by Actipro CodeHighlighter (freeware)<br />http://www.CodeHighlighter.com/<br /><br />--><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> IUser CreateUser()<br />{<br />    </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (daoPackageName.equals(</span><span style="color: #000000;">"</span><span style="color: #000000;">derby</span><span style="color: #000000;">"</span><span style="color: #000000;">)) {<br />        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> (IUser)</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> dao.derby.UserDAO();<br />    }</span><span style="color: #0000ff;">else</span><span style="color: #000000;"> </span><span style="color: #0000ff;">if</span><span style="color: #000000;">(daoPackageName.equals(</span><span style="color: #000000;">"</span><span style="color: #000000;">mysql</span><span style="color: #000000;">"</span><span style="color: #000000;">)) {<br />        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> (IUser)</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> dao.mysql.UserDAO();<br />    }</span><span style="color: #0000ff;">else</span><span style="color: #000000;"> </span><span style="color: #0000ff;">if</span><span style="color: #000000;">(daoPackageName.equals(</span><span style="color: #000000;">"</span><span style="color: #000000;">sqlserver</span><span style="color: #000000;">"</span><span style="color: #000000;">)) {<br />        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> (IUser)</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> dao.sqlserver.UserDAO();<br />    }<br />    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> </span><span style="color: #0000ff;">null</span><span style="color: #000000;">;<br />}</span></div></div></pre>
<p style="text-indent: 2em;">原因很简单，因为我都不知道到底将有多少像derby、mysql、sqlserver这样的实现类，所以使用daoPackageName判断去动态new对象是不合理的，这也违工厂模式设计的初衷，假如我现在新增一个oracle的实现类，那我岂不是又需要修改程序增加为oracle的判断，如果使用类全名动态实例则程序不需要修改任何源代码，只需要添加oracle实现类的引用，再设置daoPackageName为oracle即可。在实际应用中，完成好实现类，编译上传，接入到应用程序里，甚至可以不需要重启就能使用这个类。</p>
<p style="text-indent: 2em;">通过使用接口，我们把功能的调用推迟给实例化的子类。不同的子类，实现的方式可能又不同，就像访问不同的数据库，sql语法可能存在差异。这里贴一下我在Java里面访问数据库的类，代码如下：</p>
<pre><div class="code"><div class="codetitle"><img title="展开" src="/codehighlighter/outliningIndicators/ContractedBlock.gif" onclick="this.src=this.title=='展开'?'/codehighlighter/outliningIndicators/ExpandedBlockStart.gif':'/codehighlighter/outliningIndicators/ContractedBlock.gif'; document.getElementById('HighlighterCode_633951035561250000').style.display=this.title=='展开'?'block':'none'; this.title=this.title=='展开'?'收缩':'展开'; " /><span>Java数据库访问辅助类</span></div><div class="codemain" id="HighlighterCode_633951035561250000" style="display: none;"><div><!--<br /><br />Code highlighting produced by Actipro CodeHighlighter (freeware)<br />http://www.CodeHighlighter.com/<br /><br />--><span style="color: #008080;">  1</span><img src="/codehighlighter/outliningIndicators/ExpandedBlockStart.gif" id="CodeHighlighter1_0_18_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_0_18_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_0_18_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_0_18_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedBlock.gif" style="display: none;" id="CodeHighlighter1_0_18_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_0_18_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_0_18_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_0_18_Open_Text').style.display='inline';" /><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_0_18_Closed_Text">/**/</span><span id="CodeHighlighter1_0_18_Open_Text"><span style="color: #008000;">/*</span><span style="color: #008000;"><br /></span><span style="color: #008080;">  2</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /> * 数据库访问辅助类<br /></span><span style="color: #008080;">  3</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/ExpandedBlockEnd.gif" /> </span><span style="color: #008000;">*/</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">  4</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/None.gif" /></span><span style="color: #0000ff;">package</span><span style="color: #000000;"> db;<br /></span><span style="color: #008080;">  5</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/None.gif" /><br /></span><span style="color: #008080;">  6</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/None.gif" /></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.sql.</span><span style="color: #000000;">*</span><span style="color: #000000;">;<br /></span><span style="color: #008080;">  7</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/None.gif" /><br /></span><span style="color: #008080;">  8</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedBlockStart.gif" id="CodeHighlighter1_52_140_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_52_140_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_52_140_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_52_140_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedBlock.gif" style="display: none;" id="CodeHighlighter1_52_140_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_52_140_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_52_140_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_52_140_Open_Text').style.display='inline';" /></span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_52_140_Closed_Text">/** */</span><span id="CodeHighlighter1_52_140_Open_Text"><span style="color: #008000;">/**</span><span style="color: #008000;"><br /></span><span style="color: #008080;">  9</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /> * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> Jonllen<br /></span><span style="color: #008080;"> 10</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /> * @create 2009-05-23 19:21:40<br /></span><span style="color: #008080;"> 11</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /> * @update 2009-10-03 15:34:50<br /></span><span style="color: #008080;"> 12</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/ExpandedBlockEnd.gif" /> </span><span style="color: #008000;">*/</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;"> 13</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedBlockStart.gif" id="CodeHighlighter1_164_4852_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_164_4852_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_164_4852_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_164_4852_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedBlock.gif" style="display: none;" id="CodeHighlighter1_164_4852_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_164_4852_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_164_4852_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_164_4852_Open_Text').style.display='inline';" /></span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> SqlHelper </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_164_4852_Closed_Text">...</span><span id="CodeHighlighter1_164_4852_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 14</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /><br /></span><span style="color: #008080;"> 15</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> String ConnString </span><span style="color: #000000;">=</span><span style="color: #000000;">  DbManager.GetConfig().getDefaultItem().getConnString();<br /></span><span style="color: #008080;"> 16</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />        <br /></span><span style="color: #008080;"> 17</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> String DriverClass </span><span style="color: #000000;">=</span><span style="color: #000000;"> DbManager.GetConfig().getDefaultItem().getDriverClass();<br /></span><span style="color: #008080;"> 18</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />        <br /></span><span style="color: #008080;"> 19</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />    </span><span style="color: #008000;">//</span><span style="color: #008000;">并发处理，确保线程是同步的</span><span style="color: #008000;"><br /></span><span style="color: #008080;"> 20</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /></span><span style="color: #000000;">    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> </span><span style="color: #0000ff;">synchronized</span><span style="color: #000000;"> Connection GetConnection()<br /></span><span style="color: #008080;"> 21</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_443_1038_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_443_1038_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_443_1038_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_443_1038_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_443_1038_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_443_1038_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_443_1038_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_443_1038_Open_Text').style.display='inline';" />    </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_443_1038_Closed_Text">...</span><span id="CodeHighlighter1_443_1038_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 22</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_452_924_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_452_924_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_452_924_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_452_924_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_452_924_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_452_924_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_452_924_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_452_924_Open_Text').style.display='inline';" />         </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_452_924_Closed_Text">...</span><span id="CodeHighlighter1_452_924_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 23</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            Class.forName(DriverClass).newInstance();<br /></span><span style="color: #008080;"> 24</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            Connection conn </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">null</span><span style="color: #000000;">;<br /></span><span style="color: #008080;"> 25</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            String user </span><span style="color: #000000;">=</span><span style="color: #000000;"> DbManager.GetConfig().getDefaultItem().getUser();<br /></span><span style="color: #008080;"> 26</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            String password </span><span style="color: #000000;">=</span><span style="color: #000000;"> DbManager.GetConfig().getDefaultItem().getPassword();<br /></span><span style="color: #008080;"> 27</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #0000ff;">if</span><span style="color: #000000;">( user</span><span style="color: #000000;">!=</span><span style="color: #0000ff;">null</span><span style="color: #000000;"> </span><span style="color: #000000;">&amp;&amp;</span><span style="color: #000000;"> user.trim().length()</span><span style="color: #000000;">!=</span><span style="color: #000000;">0</span><span style="color: #000000;"> </span><span style="color: #000000;">&amp;&amp;</span><span style="color: #000000;"> password</span><span style="color: #000000;">!=</span><span style="color: #0000ff;">null</span><span style="color: #000000;"> </span><span style="color: #000000;">&amp;&amp;</span><span style="color: #000000;"> password.trim().length()</span><span style="color: #000000;">!=</span><span style="color: #000000;">0</span><span style="color: #000000;">)<br /></span><span style="color: #008080;"> 28</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_766_838_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_766_838_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_766_838_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_766_838_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_766_838_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_766_838_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_766_838_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_766_838_Open_Text').style.display='inline';" />            </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_766_838_Closed_Text">...</span><span id="CodeHighlighter1_766_838_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 29</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                conn </span><span style="color: #000000;">=</span><span style="color: #000000;"> DriverManager.getConnection(ConnString,user,password);<br /></span><span style="color: #008080;"> 30</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />            }</span></span><span style="color: #0000ff;">else</span><span style="color: #000000;"><br /></span><span style="color: #008080;"> 31</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_846_904_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_846_904_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_846_904_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_846_904_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_846_904_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_846_904_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_846_904_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_846_904_Open_Text').style.display='inline';" />            </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_846_904_Closed_Text">...</span><span id="CodeHighlighter1_846_904_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 32</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                conn </span><span style="color: #000000;">=</span><span style="color: #000000;"> DriverManager.getConnection(ConnString);<br /></span><span style="color: #008080;"> 33</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />            }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;"> 34</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> conn;<br /></span><span style="color: #008080;"> 35</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_945_1020_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_945_1020_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_945_1020_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_945_1020_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_945_1020_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_945_1020_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_945_1020_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_945_1020_Open_Text').style.display='inline';" />        }</span></span><span style="color: #000000;"> </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception e) </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_945_1020_Closed_Text">...</span><span id="CodeHighlighter1_945_1020_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 36</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            System.out.println(</span><span style="color: #000000;">"</span><span style="color: #000000;">连接数据库失败：</span><span style="color: #000000;">"</span><span style="color: #000000;"> </span><span style="color: #000000;">ConnString);<br /></span><span style="color: #008080;"> 37</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            e.printStackTrace();<br /></span><span style="color: #008080;"> 38</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />        }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;"> 39</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> </span><span style="color: #0000ff;">null</span><span style="color: #000000;">;<br /></span><span style="color: #008080;"> 40</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />    }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;"> 41</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /><br /></span><span style="color: #008080;"> 42</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> ResultSet GetProcedureResultSet(String sql )<br /></span><span style="color: #008080;"> 43</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_1101_1154_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_1101_1154_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_1101_1154_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_1101_1154_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_1101_1154_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_1101_1154_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_1101_1154_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_1101_1154_Open_Text').style.display='inline';" />    </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_1101_1154_Closed_Text">...</span><span id="CodeHighlighter1_1101_1154_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 44</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> GetProcedureResultSet(sql, </span><span style="color: #0000ff;">null</span><span style="color: #000000;">, </span><span style="color: #0000ff;">null</span><span style="color: #000000;">);<br /></span><span style="color: #008080;"> 45</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />    }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;"> 46</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /><br /></span><span style="color: #008080;"> 47</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> ResultSet GetProcedureResultSet(String sql, Object[][] inargs)<br /></span><span style="color: #008080;"> 48</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_1235_1290_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_1235_1290_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_1235_1290_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_1235_1290_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_1235_1290_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_1235_1290_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_1235_1290_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_1235_1290_Open_Text').style.display='inline';" />    </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_1235_1290_Closed_Text">...</span><span id="CodeHighlighter1_1235_1290_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 49</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> GetProcedureResultSet(sql, inargs, </span><span style="color: #0000ff;">null</span><span style="color: #000000;">);<br /></span><span style="color: #008080;"> 50</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />    }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;"> 51</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /><br /></span><span style="color: #008080;"> 52</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> ResultSet GetProcedureResultSet(String sql, Object[][] inargs, Object[][] outargs)<br /></span><span style="color: #008080;"> 53</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_1391_2291_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_1391_2291_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_1391_2291_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_1391_2291_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_1391_2291_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_1391_2291_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_1391_2291_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_1391_2291_Open_Text').style.display='inline';" />    </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_1391_2291_Closed_Text">...</span><span id="CodeHighlighter1_1391_2291_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 54</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />        Connection con </span><span style="color: #000000;">=</span><span style="color: #000000;"> GetConnection();<br /></span><span style="color: #008080;"> 55</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />        CallableStatement cstmt </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">null</span><span style="color: #000000;">;<br /></span><span style="color: #008080;"> 56</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_1469_2182_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_1469_2182_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_1469_2182_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_1469_2182_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_1469_2182_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_1469_2182_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_1469_2182_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_1469_2182_Open_Text').style.display='inline';" />        </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_1469_2182_Closed_Text">...</span><span id="CodeHighlighter1_1469_2182_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 57</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            cstmt </span><span style="color: #000000;">=</span><span style="color: #000000;"> con.prepareCall(sql);<br /></span><span style="color: #008080;"> 58</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #0000ff;">if</span><span style="color: #000000;">(inargs</span><span style="color: #000000;">!=</span><span style="color: #0000ff;">null</span><span style="color: #000000;"> </span><span style="color: #000000;">&amp;&amp;</span><span style="color: #000000;"> inargs.length</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">0</span><span style="color: #000000;">)<br /></span><span style="color: #008080;"> 59</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_1546_1674_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_1546_1674_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_1546_1674_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_1546_1674_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_1546_1674_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_1546_1674_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_1546_1674_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_1546_1674_Open_Text').style.display='inline';" />            </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_1546_1674_Closed_Text">...</span><span id="CodeHighlighter1_1546_1674_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 60</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                </span><span style="color: #008000;">//</span><span style="color: #008000;">设置输入参数</span><span style="color: #008000;"><br /></span><span style="color: #008080;"> 61</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /></span><span style="color: #000000;">                </span><span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> i</span><span style="color: #000000;">=</span><span style="color: #000000;">0</span><span style="color: #000000;">;i</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">inargs.length;i</span><span style="color: #000000;">  </span><span style="color: #000000;">)<br /></span><span style="color: #008080;"> 62</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_1602_1669_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_1602_1669_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_1602_1669_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_1602_1669_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_1602_1669_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_1602_1669_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_1602_1669_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_1602_1669_Open_Text').style.display='inline';" />                </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_1602_1669_Closed_Text">...</span><span id="CodeHighlighter1_1602_1669_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 63</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                    cstmt.setObject(inargs[i][</span><span style="color: #000000;">0</span><span style="color: #000000;">].toString(),inargs[i][</span><span style="color: #000000;">1</span><span style="color: #000000;">]);<br /></span><span style="color: #008080;"> 64</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />                }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;"> 65</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />            }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;"> 66</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (outargs</span><span style="color: #000000;">!=</span><span style="color: #0000ff;">null</span><span style="color: #000000;"> </span><span style="color: #000000;">&amp;&amp;</span><span style="color: #000000;"> outargs.length</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">0</span><span style="color: #000000;">)<br /></span><span style="color: #008080;"> 67</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_1720_1896_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_1720_1896_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_1720_1896_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_1720_1896_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_1720_1896_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_1720_1896_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_1720_1896_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_1720_1896_Open_Text').style.display='inline';" />            </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_1720_1896_Closed_Text">...</span><span id="CodeHighlighter1_1720_1896_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 68</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                </span><span style="color: #008000;">//</span><span style="color: #008000;">如果有多个输出参数则注册</span><span style="color: #008000;"><br /></span><span style="color: #008080;"> 69</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /></span><span style="color: #000000;">                </span><span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> i</span><span style="color: #000000;">=</span><span style="color: #000000;">0</span><span style="color: #000000;">;i</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">outargs.length;i</span><span style="color: #000000;">  </span><span style="color: #000000;">)<br /></span><span style="color: #008080;"> 70</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_1783_1891_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_1783_1891_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_1783_1891_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_1783_1891_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_1783_1891_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_1783_1891_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_1783_1891_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_1783_1891_Open_Text').style.display='inline';" />                </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_1783_1891_Closed_Text">...</span><span id="CodeHighlighter1_1783_1891_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 71</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                    cstmt.registerOutParameter(outargs[i][</span><span style="color: #000000;">0</span><span style="color: #000000;">].toString(),Integer.valueOf(outargs[i][</span><span style="color: #000000;">1</span><span style="color: #000000;">].toString()));<br /></span><span style="color: #008080;"> 72</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />                }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;"> 73</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />            }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;"> 74</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            Boolean b </span><span style="color: #000000;">=</span><span style="color: #000000;"> cstmt.execute();<br /></span><span style="color: #008080;"> 75</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (outargs</span><span style="color: #000000;">!=</span><span style="color: #0000ff;">null</span><span style="color: #000000;"> </span><span style="color: #000000;">&amp;&amp;</span><span style="color: #000000;"> outargs.length</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">0</span><span style="color: #000000;">)<br /></span><span style="color: #008080;"> 76</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_1974_2125_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_1974_2125_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_1974_2125_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_1974_2125_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_1974_2125_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_1974_2125_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_1974_2125_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_1974_2125_Open_Text').style.display='inline';" />            </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_1974_2125_Closed_Text">...</span><span id="CodeHighlighter1_1974_2125_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 77</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                </span><span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> i</span><span style="color: #000000;">=</span><span style="color: #000000;">0</span><span style="color: #000000;">;i</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">outargs.length;i</span><span style="color: #000000;">  </span><span style="color: #000000;">)<br /></span><span style="color: #008080;"> 78</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_2018_2120_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2018_2120_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_2018_2120_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2018_2120_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_2018_2120_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2018_2120_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_2018_2120_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2018_2120_Open_Text').style.display='inline';" />                </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_2018_2120_Closed_Text">...</span><span id="CodeHighlighter1_2018_2120_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 79</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                    </span><span style="color: #008000;">//</span><span style="color: #008000;">把原来 输出参数 的类型 变成输出参数值 返回</span><span style="color: #008000;"><br /></span><span style="color: #008080;"> 80</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /></span><span style="color: #000000;">                    outargs[i][</span><span style="color: #000000;">1</span><span style="color: #000000;">] </span><span style="color: #000000;">=</span><span style="color: #000000;"> cstmt.getObject(outargs[i][</span><span style="color: #000000;">0</span><span style="color: #000000;">].toString());<br /></span><span style="color: #008080;"> 81</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />                }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;"> 82</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />            }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;"> 83</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (b)<br /></span><span style="color: #008080;"> 84</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_2139_2178_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2139_2178_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_2139_2178_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2139_2178_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_2139_2178_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2139_2178_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_2139_2178_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2139_2178_Open_Text').style.display='inline';" />            </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_2139_2178_Closed_Text">...</span><span id="CodeHighlighter1_2139_2178_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 85</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> cstmt.getResultSet();<br /></span><span style="color: #008080;"> 86</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />            }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;"> 87</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_2206_2273_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2206_2273_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_2206_2273_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2206_2273_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_2206_2273_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2206_2273_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_2206_2273_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2206_2273_Open_Text').style.display='inline';" />        }</span></span><span style="color: #000000;"> </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (SQLException e) </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_2206_2273_Closed_Text">...</span><span id="CodeHighlighter1_2206_2273_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 88</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated catch block</span><span style="color: #008000;"><br /></span><span style="color: #008080;"> 89</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /></span><span style="color: #000000;">            e.printStackTrace();<br /></span><span style="color: #008080;"> 90</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />        }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;"> 91</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> </span><span style="color: #0000ff;">null</span><span style="color: #000000;">;<br /></span><span style="color: #008080;"> 92</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />    }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;"> 93</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /><br /></span><span style="color: #008080;"> 94</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> ResultSet GetResultSet(String sql)<br /></span><span style="color: #008080;"> 95</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_2344_2634_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2344_2634_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_2344_2634_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2344_2634_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_2344_2634_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2344_2634_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_2344_2634_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2344_2634_Open_Text').style.display='inline';" />    </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_2344_2634_Closed_Text">...</span><span id="CodeHighlighter1_2344_2634_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 96</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />        Connection con </span><span style="color: #000000;">=</span><span style="color: #000000;"> GetConnection();<br /></span><span style="color: #008080;"> 97</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_2388_2525_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2388_2525_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_2388_2525_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2388_2525_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_2388_2525_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2388_2525_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_2388_2525_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2388_2525_Open_Text').style.display='inline';" />        </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_2388_2525_Closed_Text">...</span><span id="CodeHighlighter1_2388_2525_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;"> 98</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #008000;">//</span><span style="color: #008000;">PreparedStatement pstmt = con.prepareStatement();</span><span style="color: #008000;"><br /></span><span style="color: #008080;"> 99</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /></span><span style="color: #000000;">            Statement stmt </span><span style="color: #000000;">=</span><span style="color: #000000;"> con.createStatement();<br /></span><span style="color: #008080;">100</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> stmt.executeQuery(sql);<br /></span><span style="color: #008080;">101</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_2549_2616_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2549_2616_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_2549_2616_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2549_2616_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_2549_2616_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2549_2616_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_2549_2616_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2549_2616_Open_Text').style.display='inline';" />        }</span></span><span style="color: #000000;"> </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (SQLException e) </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_2549_2616_Closed_Text">...</span><span id="CodeHighlighter1_2549_2616_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">102</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated catch block</span><span style="color: #008000;"><br /></span><span style="color: #008080;">103</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /></span><span style="color: #000000;">            e.printStackTrace();<br /></span><span style="color: #008080;">104</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />        }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">105</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> </span><span style="color: #0000ff;">null</span><span style="color: #000000;">;<br /></span><span style="color: #008080;">106</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />    }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">107</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /><br /></span><span style="color: #008080;">108</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> ResultSet GetResultSet(String sql, Object ... parms)<br /></span><span style="color: #008080;">109</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_2705_3282_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2705_3282_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_2705_3282_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2705_3282_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_2705_3282_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2705_3282_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_2705_3282_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2705_3282_Open_Text').style.display='inline';" />    </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_2705_3282_Closed_Text">...</span><span id="CodeHighlighter1_2705_3282_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">110</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />        Connection con </span><span style="color: #000000;">=</span><span style="color: #000000;"> GetConnection();<br /></span><span style="color: #008080;">111</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_2749_3173_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2749_3173_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_2749_3173_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2749_3173_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_2749_3173_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2749_3173_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_2749_3173_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2749_3173_Open_Text').style.display='inline';" />        </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_2749_3173_Closed_Text">...</span><span id="CodeHighlighter1_2749_3173_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">112</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            PreparedStatement pstmt </span><span style="color: #000000;">=</span><span style="color: #000000;"> con.prepareStatement(sql);<br /></span><span style="color: #008080;">113</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #0000ff;">if</span><span style="color: #000000;">(parms</span><span style="color: #000000;">!=</span><span style="color: #0000ff;">null</span><span style="color: #000000;"> </span><span style="color: #000000;">&amp;&amp;</span><span style="color: #000000;"> parms.length</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">0</span><span style="color: #000000;">)<br /></span><span style="color: #008080;">114</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_2847_2950_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2847_2950_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_2847_2950_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2847_2950_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_2847_2950_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2847_2950_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_2847_2950_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2847_2950_Open_Text').style.display='inline';" />            </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_2847_2950_Closed_Text">...</span><span id="CodeHighlighter1_2847_2950_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">115</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                </span><span style="color: #008000;">//</span><span style="color: #008000;">设置输入参数</span><span style="color: #008000;"><br /></span><span style="color: #008080;">116</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /></span><span style="color: #000000;">                </span><span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> i</span><span style="color: #000000;">=</span><span style="color: #000000;">0</span><span style="color: #000000;">;i</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">parms.length;i</span><span style="color: #000000;">  </span><span style="color: #000000;">)<br /></span><span style="color: #008080;">117</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_2902_2945_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2902_2945_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_2902_2945_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2902_2945_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_2902_2945_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_2902_2945_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_2902_2945_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_2902_2945_Open_Text').style.display='inline';" />                </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_2902_2945_Closed_Text">...</span><span id="CodeHighlighter1_2902_2945_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">118</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                    pstmt.setObject(i</span><span style="color: #000000;"> </span><span style="color: #000000;">1</span><span style="color: #000000;">,parms[i]);<br /></span><span style="color: #008080;">119</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />                }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">120</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />            }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">121</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #0000ff;">boolean</span><span style="color: #000000;"> hasResutl </span><span style="color: #000000;">=</span><span style="color: #000000;"> pstmt.execute();<br /></span><span style="color: #008080;">122</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (hasResutl) </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> pstmt.getResultSet();<br /></span><span style="color: #008080;">123</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_3068_3107_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3068_3107_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_3068_3107_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3068_3107_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_3068_3107_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3068_3107_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_3068_3107_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3068_3107_Open_Text').style.display='inline';" />            </span><span style="color: #0000ff;">if</span><span style="color: #000000;">(pstmt.getMoreResults() )</span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_3068_3107_Closed_Text">...</span><span id="CodeHighlighter1_3068_3107_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">124</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> pstmt.getResultSet();<br /></span><span style="color: #008080;">125</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />            }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">126</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            System.out.println(</span><span style="color: #000000;">"</span><span style="color: #000000;">UpdateCount:</span><span style="color: #000000;">"</span><span style="color: #000000;"> </span><span style="color: #000000;">pstmt.getUpdateCount());<br /></span><span style="color: #008080;">127</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_3197_3264_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3197_3264_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_3197_3264_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3197_3264_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_3197_3264_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3197_3264_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_3197_3264_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3197_3264_Open_Text').style.display='inline';" />        }</span></span><span style="color: #000000;"> </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (SQLException e) </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_3197_3264_Closed_Text">...</span><span id="CodeHighlighter1_3197_3264_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">128</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated catch block</span><span style="color: #008000;"><br /></span><span style="color: #008080;">129</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /></span><span style="color: #000000;">            e.printStackTrace();<br /></span><span style="color: #008080;">130</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />        }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">131</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> </span><span style="color: #0000ff;">null</span><span style="color: #000000;">;<br /></span><span style="color: #008080;">132</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />    }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">133</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /><br /></span><span style="color: #008080;">134</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> Object ExcuteSclare(String sql, Object ... parms)<br /></span><span style="color: #008080;">135</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_3350_3653_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3350_3653_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_3350_3653_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3350_3653_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_3350_3653_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3350_3653_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_3350_3653_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3350_3653_Open_Text').style.display='inline';" />    </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_3350_3653_Closed_Text">...</span><span id="CodeHighlighter1_3350_3653_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">136</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />        ResultSet rs </span><span style="color: #000000;">=</span><span style="color: #000000;"> GetResultSet(sql, parms);<br /></span><span style="color: #008080;">137</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_3401_3506_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3401_3506_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_3401_3506_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3401_3506_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_3401_3506_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3401_3506_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_3401_3506_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3401_3506_Open_Text').style.display='inline';" />        </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_3401_3506_Closed_Text">...</span><span id="CodeHighlighter1_3401_3506_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">138</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #0000ff;">if</span><span style="color: #000000;">( rs</span><span style="color: #000000;">!=</span><span style="color: #0000ff;">null</span><span style="color: #000000;"> </span><span style="color: #000000;">&amp;&amp;</span><span style="color: #000000;"> rs.next())<br /></span><span style="color: #008080;">139</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_3436_3470_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3436_3470_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_3436_3470_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3436_3470_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_3436_3470_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3436_3470_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_3436_3470_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3436_3470_Open_Text').style.display='inline';" />            </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_3436_3470_Closed_Text">...</span><span id="CodeHighlighter1_3436_3470_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">140</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> rs.getObject(</span><span style="color: #000000;">1</span><span style="color: #000000;">);<br /></span><span style="color: #008080;">141</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />            }</span></span><span style="color: #0000ff;">else</span><span style="color: #000000;"> System.out.println(</span><span style="color: #000000;">"</span><span style="color: #000000;">NULL</span><span style="color: #000000;">"</span><span style="color: #000000;">);<br /></span><span style="color: #008080;">142</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_3530_3597_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3530_3597_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_3530_3597_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3530_3597_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_3530_3597_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3530_3597_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_3530_3597_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3530_3597_Open_Text').style.display='inline';" />        }</span></span><span style="color: #000000;"> </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (SQLException e) </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_3530_3597_Closed_Text">...</span><span id="CodeHighlighter1_3530_3597_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">143</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated catch block</span><span style="color: #008000;"><br /></span><span style="color: #008080;">144</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /></span><span style="color: #000000;">            e.printStackTrace();<br /></span><span style="color: #008080;">145</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_3604_3635_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3604_3635_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_3604_3635_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3604_3635_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_3604_3635_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3604_3635_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_3604_3635_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3604_3635_Open_Text').style.display='inline';" />        }</span></span><span style="color: #0000ff;">finally</span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_3604_3635_Closed_Text">...</span><span id="CodeHighlighter1_3604_3635_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">146</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            CloseConnection( rs );<br /></span><span style="color: #008080;">147</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />        }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">148</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> </span><span style="color: #0000ff;">null</span><span style="color: #000000;">;<br /></span><span style="color: #008080;">149</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />    }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">150</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /><br /></span><span style="color: #008080;">151</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> ExecuteQuery(String sql, Object ... parms)<br /></span><span style="color: #008080;">152</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_3718_4144_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3718_4144_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_3718_4144_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3718_4144_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_3718_4144_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3718_4144_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_3718_4144_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3718_4144_Open_Text').style.display='inline';" />    </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_3718_4144_Closed_Text">...</span><span id="CodeHighlighter1_3718_4144_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">153</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />        Connection con </span><span style="color: #000000;">=</span><span style="color: #000000;"> GetConnection();<br /></span><span style="color: #008080;">154</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_3762_4000_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3762_4000_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_3762_4000_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3762_4000_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_3762_4000_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3762_4000_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_3762_4000_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3762_4000_Open_Text').style.display='inline';" />        </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_3762_4000_Closed_Text">...</span><span id="CodeHighlighter1_3762_4000_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">155</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            PreparedStatement pstmt </span><span style="color: #000000;">=</span><span style="color: #000000;"> con.prepareStatement(sql);<br /></span><span style="color: #008080;">156</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #0000ff;">if</span><span style="color: #000000;">(parms</span><span style="color: #000000;">!=</span><span style="color: #0000ff;">null</span><span style="color: #000000;"> </span><span style="color: #000000;">&amp;&amp;</span><span style="color: #000000;"> parms.length</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">0</span><span style="color: #000000;">)<br /></span><span style="color: #008080;">157</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_3860_3963_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3860_3963_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_3860_3963_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3860_3963_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_3860_3963_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3860_3963_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_3860_3963_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3860_3963_Open_Text').style.display='inline';" />            </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_3860_3963_Closed_Text">...</span><span id="CodeHighlighter1_3860_3963_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">158</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                </span><span style="color: #008000;">//</span><span style="color: #008000;">设置输入参数</span><span style="color: #008000;"><br /></span><span style="color: #008080;">159</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /></span><span style="color: #000000;">                </span><span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> i</span><span style="color: #000000;">=</span><span style="color: #000000;">0</span><span style="color: #000000;">;i</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">parms.length;i</span><span style="color: #000000;">  </span><span style="color: #000000;">)<br /></span><span style="color: #008080;">160</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_3915_3958_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3915_3958_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_3915_3958_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3915_3958_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_3915_3958_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_3915_3958_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_3915_3958_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_3915_3958_Open_Text').style.display='inline';" />                </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_3915_3958_Closed_Text">...</span><span id="CodeHighlighter1_3915_3958_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">161</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                    pstmt.setObject(i</span><span style="color: #000000;"> </span><span style="color: #000000;">1</span><span style="color: #000000;">,parms[i]);<br /></span><span style="color: #008080;">162</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />                }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">163</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />            }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">164</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> pstmt.executeUpdate();<br /></span><span style="color: #008080;">165</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_4024_4091_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4024_4091_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_4024_4091_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4024_4091_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_4024_4091_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4024_4091_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_4024_4091_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4024_4091_Open_Text').style.display='inline';" />        }</span></span><span style="color: #000000;"> </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (SQLException e) </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_4024_4091_Closed_Text">...</span><span id="CodeHighlighter1_4024_4091_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">166</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated catch block</span><span style="color: #008000;"><br /></span><span style="color: #008080;">167</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /></span><span style="color: #000000;">            e.printStackTrace();<br /></span><span style="color: #008080;">168</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_4098_4128_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4098_4128_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_4098_4128_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4098_4128_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_4098_4128_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4098_4128_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_4098_4128_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4098_4128_Open_Text').style.display='inline';" />        }</span></span><span style="color: #0000ff;">finally</span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_4098_4128_Closed_Text">...</span><span id="CodeHighlighter1_4098_4128_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">169</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            CloseConnection(con);<br /></span><span style="color: #008080;">170</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />        }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">171</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> </span><span style="color: #000000;">-</span><span style="color: #000000;">1</span><span style="color: #000000;">;<br /></span><span style="color: #008080;">172</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />    }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">173</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /><br /></span><span style="color: #008080;">174</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> CloseConnection(ResultSet rs)<br /></span><span style="color: #008080;">175</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_4197_4548_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4197_4548_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_4197_4548_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4197_4548_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_4197_4548_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4197_4548_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_4197_4548_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4197_4548_Open_Text').style.display='inline';" />    </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_4197_4548_Closed_Text">...</span><span id="CodeHighlighter1_4197_4548_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">176</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /><br /></span><span style="color: #008080;">177</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_4206_4388_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4206_4388_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_4206_4388_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4206_4388_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_4206_4388_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4206_4388_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_4206_4388_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4206_4388_Open_Text').style.display='inline';" />        </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_4206_4388_Closed_Text">...</span><span id="CodeHighlighter1_4206_4388_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">178</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (rs</span><span style="color: #000000;">!=</span><span style="color: #0000ff;">null</span><span style="color: #000000;"> </span><span style="color: #000000;">&amp;&amp;</span><span style="color: #000000;"> rs.getStatement()</span><span style="color: #000000;">!=</span><span style="color: #0000ff;">null</span><span style="color: #000000;"> </span><span style="color: #000000;">&amp;&amp;</span><span style="color: #000000;"> rs.getStatement().getConnection()</span><span style="color: #000000;">!=</span><span style="color: #0000ff;">null</span><span style="color: #000000;">)<br /></span><span style="color: #008080;">179</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_4298_4384_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4298_4384_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_4298_4384_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4298_4384_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_4298_4384_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4298_4384_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_4298_4384_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4298_4384_Open_Text').style.display='inline';" />            </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_4298_4384_Closed_Text">...</span><span id="CodeHighlighter1_4298_4384_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">180</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                </span><span style="color: #008000;">//</span><span style="color: #008000;">rs.getStatement().close();</span><span style="color: #008000;"><br /></span><span style="color: #008080;">181</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /></span><span style="color: #000000;">                rs.getStatement().getConnection().close();<br /></span><span style="color: #008080;">182</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />            }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">183</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_4412_4545_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4412_4545_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_4412_4545_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4412_4545_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_4412_4545_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4412_4545_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_4412_4545_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4412_4545_Open_Text').style.display='inline';" />        }</span></span><span style="color: #000000;"> </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (SQLException e) </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_4412_4545_Closed_Text">...</span><span id="CodeHighlighter1_4412_4545_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">184</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            </span><span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated catch block</span><span style="color: #008000;"><br /></span><span style="color: #008080;">185</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /></span><span style="color: #000000;">            e.printStackTrace();<br /></span><span style="color: #008080;">186</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />            System.out.println(</span><span style="color: #000000;">"</span><span style="color: #000000;">关闭连接时出错(From ResultSet)！</span><span style="color: #000000;">"</span><span style="color: #000000;"> </span><span style="color: #000000;">e.getMessage());<br /></span><span style="color: #008080;">187</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />        }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">188</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />    }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">189</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /><br /></span><span style="color: #008080;">190</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> CloseConnection(Connection con)<br /></span><span style="color: #008080;">191</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_4603_4848_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4603_4848_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_4603_4848_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4603_4848_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_4603_4848_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4603_4848_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_4603_4848_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4603_4848_Open_Text').style.display='inline';" />    </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_4603_4848_Closed_Text">...</span><span id="CodeHighlighter1_4603_4848_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">192</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_4611_4684_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4611_4684_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_4611_4684_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4611_4684_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_4611_4684_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4611_4684_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_4611_4684_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4611_4684_Open_Text').style.display='inline';" />        </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_4611_4684_Closed_Text">...</span><span id="CodeHighlighter1_4611_4684_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">193</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (con</span><span style="color: #000000;">!=</span><span style="color: #0000ff;">null</span><span style="color: #000000;"> </span><span style="color: #000000;">&amp;&amp;</span><span style="color: #000000;"> </span><span style="color: #000000;">!</span><span style="color: #000000;">con.isClosed())<br /></span><span style="color: #008080;">194</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_4655_4680_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4655_4680_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_4655_4680_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4655_4680_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_4655_4680_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4655_4680_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_4655_4680_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4655_4680_Open_Text').style.display='inline';" />                </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_4655_4680_Closed_Text">...</span><span id="CodeHighlighter1_4655_4680_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">195</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                    con.close();<br /></span><span style="color: #008080;">196</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />                }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">197</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockStart.gif" id="CodeHighlighter1_4708_4845_Open_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4708_4845_Open_Text').style.display='none'; document.getElementById('CodeHighlighter1_4708_4845_Closed_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4708_4845_Closed_Text').style.display='inline';" /><img src="/codehighlighter/outliningIndicators/ContractedSubBlock.gif" style="display: none;" id="CodeHighlighter1_4708_4845_Closed_Image" onclick="this.style.display='none'; document.getElementById('CodeHighlighter1_4708_4845_Closed_Text').style.display='none'; document.getElementById('CodeHighlighter1_4708_4845_Open_Image').style.display='inline'; document.getElementById('CodeHighlighter1_4708_4845_Open_Text').style.display='inline';" />        }</span></span><span style="color: #000000;"> </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (SQLException e) </span><span style="border: solid 1px #808080; background-color: #ffffff; display: none;" id="CodeHighlighter1_4708_4845_Closed_Text">...</span><span id="CodeHighlighter1_4708_4845_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">198</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                </span><span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated catch block</span><span style="color: #008000;"><br /></span><span style="color: #008080;">199</span><span style="color: #008000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /></span><span style="color: #000000;">                e.printStackTrace();<br /></span><span style="color: #008080;">200</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" />                System.out.println(</span><span style="color: #000000;">"</span><span style="color: #000000;">关闭连接时出错(From Connection)！</span><span style="color: #000000;">"</span><span style="color: #000000;"> </span><span style="color: #000000;">e.getMessage());<br /></span><span style="color: #008080;">201</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />        }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">202</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedSubBlockEnd.gif" />    }</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">203</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /><br /></span><span style="color: #008080;">204</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/InBlock.gif" /><br /></span><span style="color: #008080;">205</span><span style="color: #000000;"><img src="/codehighlighter/outliningIndicators/ExpandedBlockEnd.gif" />}</span></span></div></div></div></pre>
<p style="text-indent: 2em;">其实，不同的数据库在细节上的差异还是有很多的，比如像自动增长主键的处理等。我这个事例中用了三种数据库：derby、mysql、sqlserver，由于derby是装NetBeans自带开源免费的数据库，以前从没有听说过，所以在插入用户的时候只能先查出最大编号做为主键插入，而在mysql里插入自动编号则显示的指定为default，sqlserver里自增主键列则不需要指定，如果是oracle的话还需要使用序列。另外不同的数据库函数使用也不一，如取当前时间access和mysql是使用now()，sqlserver里则是getdate()，oracle里用SYSDATE，这些都是我们需要注意的，说不定我们的项目那一天就需要移植到另一种数据库。</p>
<p style="text-indent: 2em;">java里访问数据库都是使用java.sql.*下面的类，然后加载驱动文件。而.Net里则是提供了IConnection、IDataReader、IDbDataParameter等接口，并且为不同种数据库提供了专门的命名空间，提高访问效率。下面我整理java里访问sql2000、sql2005、mysql、derby数据库的连接字符串、驱动包类名表列出比较。</p>
<div style="overflow: auto; width: 500px;">
<table style="border: solid 1px #ccc; border-collapse: collapse;" cellpadding="2" class="tab">
<tr style="background-color: #999999;">
<th>数据库</th><th>连接字符串</th><th>驱动包</th>
</tr>
<tr>
<td>sql2000</td>
<td>jdbc:microsoft:sqlserver://localhost;databaseName=master;user=sa;password=123</td>
<td>com.microsoft.jdbc.sqlserver.SQLServerDriver</td>
</tr>
<tr>
<td>sql2005</td>
<td>jdbc:sqlserver://localhost\sql2005;databaseName=dbTest;user=sa;password=123</td>
<td>com.microsoft.sqlserver.jdbc.SQLServerDriver</td>
</tr>
<tr>
<td>mysql</td>
<td>jdbc:mysql://localhost:3306/dbtest?user=root&amp;password=123&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;allowMultiQueries=true</td>
<td>com.mysql.jdbc.Driver</td>
</tr>
<tr>
<td>derby</td>
<td>jdbc:derby://localhost:1527/dbTest;create=true;user=app;password=app</td>
<td>org.apache.derby.jdbc.ClientDriver</td>
</tr>
<tr>
<td>oracle</td>
<td>jdbc:oracle:thin:system/123:@localhost:1521:orcl</td>
<td>oracle.jdbc.driver.OracleDriver</td>
</tr>
</table>
</div>
<p style="text-indent: 2em;">这些信息是配置在我工程connector.properties资源文件里的，把数据库名做为key，然后对应connString连接字符串、driverClass驱动类多个属性，使用DbManager单件类读取到，以确保只读取一次资源文件，由于要做到在线切换数据库，而不是重起应用程序后才能生效，而之前DataAccess的daoPackageName、SqlHelper的ConnString和DriverClass静态字段只会在初始化读取一次，所以切换数据库的时候也重新指定这些静态字段，不然还会是初始化时候的值，代码如下：</p>
<pre><div class="code"><div><!--<br /><br />Code highlighting produced by Actipro CodeHighlighter (freeware)<br />http://www.CodeHighlighter.com/<br /><br />--><span style="color: #0000ff;">public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> setDefaultName(String defaultName) {<br />        </span><span style="color: #0000ff;">for</span><span style="color: #000000;">(DbItem item : </span><span style="color: #0000ff;">this</span><span style="color: #000000;">.list)<br />        {<br />            </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (item.getDbName().equalsIgnoreCase(defaultName))<br />            {<br />                System.out.println(</span><span style="color: #000000;">"</span><span style="color: #000000;">修改设置当前数据库为：</span><span style="color: #000000;">"</span><span style="color: #000000;"> </span><span style="color: #000000;"> </span><span style="color: #000000;"> defaultName );<br /><br />                </span><span style="color: #0000ff;">this</span><span style="color: #000000;">.defaultName </span><span style="color: #000000;">=</span><span style="color: #000000;"> defaultName;<br />                </span><span style="color: #0000ff;">this</span><span style="color: #000000;">.defaultItem </span><span style="color: #000000;">=</span><span style="color: #000000;"> item;<br /><br />                dal.DataAccess.daoPackageName </span><span style="color: #000000;">=</span><span style="color: #000000;"> item.getPackageName();<br />                db.SqlHelper.ConnString </span><span style="color: #000000;">=</span><span style="color: #000000;"> item.getConnString();<br />                db.SqlHelper.DriverClass </span><span style="color: #000000;">=</span><span style="color: #000000;"> item.getDriverClass();<br />            }<br />        }<br />        <br />    }</span></div></div></pre>
<p style="text-indent: 2em;">这样切换数据库的功能就实现了，所有页面功能的调用是在BLL业务逻辑层，这一层就是使用接口实例调用方法。好了不多说了，有什么问题可以下载NetBeans工程的源代码，仍然是和上一篇struts同一工程。</p>
<p style="text-indent: 2em;"><a href="http://files.cnblogs.com/Jonllen/JavaWeb(Struts事例).rar" target="Java工厂模式切换数据库实例源代码下载"><strong>Java工厂模式切换数据库实例源代码下载(带Struts的增、删、改、查功能)</strong></a></p>
</div>
			</div>
			<script type="text/javascript" src="/styles/index/scripts/ImgLazy.js"></script>
	        <script type="text/javascript">new ImgLazy( { selector : 'content', maxWidth : document.getElementById('content').offsetWidth, loadSrc : '/styles/index/css/default/images/lazyloading.gif' });</script>

			<div class="tags">标签：<a href="/jonllen/java/">Java</a> 工厂模式
			    
			    
			</div>

			<div class="desc">
			  <ul>
				<li>posted@ 2009-10-23 09:33</li>
				<li>update@ 2009-11-29 15:04:35</li>
				<li>阅读(<span id="articleClick">13500</span>)</li>
				<li>评论(0)</li>
				
			  </ul>
			</div>
			<script type="text/javascript" src="/styles/index/scripts/ad.js"></script>

		</div>
<div class="context">
			<ul>
				<li>上一篇：<a href="/jonllen/java/struts.html">Struts增删改查实例及源代码下载</a></li>
<li>下一篇：<a href="/jonllen/java/100.html">Struts+Hibernate学习笔记</a></li></ul>
		</div>
		

<div class="correlative">
	
		    <h4>相关文章</h4>
			<ul>



			</ul>
		
</div>

		
		<div class="comment">
			<div class="title">评论</div>
			<div class="commentlist" id="commentContent">
				

				<div id="commentNothing" class="nothing">
	暂无任何评论。
</div>
			</div>
		</div>
		<div class="postcomment">
	        <div class="title">发表评论<a id="comment"></a></div>
	        <div class="box">
		        <div class="fi"><label>用户名</label><input id="txtUserName" type="text" value="" class="text" title="请输入显示用户名称" /><span class="note">*必填</span></div>
		        
		        
		        <div class="fi"><label>网站链接</label><input id="txtWebsite" type="text" class="text" title="请输入您的网站链接地址以便回访（非必填）" /></div>
		        
		        <div class="fi"><label>邮箱地址</label><input id="txtEmail" type="text" class="text" title="请输入您的邮箱地址以便回复（非必填）" /><input id="chkEmailNotify" type="checkbox" title="当博主回复时以邮件通知我" />回复通知我</div>
		        <div class="fi"><label>内容</label><textarea id="txtContent" class="textarea"></textarea><span class="note">*必填</span></div>
		        <div class="btn"><input type="button" class="submit" onclick="postComment()" value="提交" /></div>
	        </div>
        </div>
        <script type="text/javascript" src="/styles/index/scripts/ajax.js"></script>
        <script type="text/javascript">
            function postComment()
		    {
		        var url = "/plugin/web/doSaveComment.do?sourcetype=1&sourceid=78&siteId=1";
		        var data = "username="+encodeURIComponent(document.getElementById("txtUserName").value);
		        data += '&sourceurl=/jonllen/java/78.html';
		        data += "&content="+ encodeURIComponent(document.getElementById("txtContent").value);
		        var pwd = document.getElementById("txtPassword");
		        if (pwd!=null)
		        {
		            data += "&pwd="+ pwd.value;
		        }
		        var website = document.getElementById("txtWebsite");
		        if (website!=null)
		        {
		            data += "&website="+ website.value;
		        }
		        data += "&email="+ encodeURIComponent(document.getElementById("txtEmail").value);
		        data += "&emailNotify="+ encodeURIComponent(document.getElementById("chkEmailNotify").checked);
		        Ajax.send({
		            type : "POST",
		            url : url,
		            data : data,
		            fn : function (data){
	                    var rs;
	                    try{rs=eval("rs="+data);}catch(e){alert(e);return;}
                        
	                    if (rs.success)
	                    {
	                        appendComment();
	                        if(document.getElementById('commentNothing')!=null){ 
	                          document.getElementById('commentNothing').style.display = 'none';
	                        }
	                        document.getElementById("txtContent").value = "";
	                        alert("提交评论成功！");
	                    }else
	                    {
	                        alert(rs.error);
	                    }
                            }
		        });
		    }

function appendComment()
		    {
var itemComment = document.createElement('div');
itemComment.className = 'item';
var username = document.getElementById("txtUserName").value;
var index = document.getElementById('commentContent').getElementsByTagName('ul').length + 1;
var content =  document.getElementById("txtContent").value;
itemComment.innerHTML = '<div class="desc"><ul class="options"><li><a href="javascript:;" onclick="quote(this,\''+username+'\')">引用</a></li></ul><a>'+index+'楼</a> '+username+'</div><div class="cont">'+content+'</div>';
document.getElementById('commentContent').appendChild(itemComment);
}

            function addClick()
		    {
		        var url = "/plugin/web/doAddClick.do?columnType=1&documentId=78";
		        Ajax.send({
		            type : "GET",
		            url : url,
		            fn : function (data){
		                 var clickElem = document.getElementById('articleClick');
		                 if(clickElem !=null) clickElem.innerHTML = data; 
		            }
		        });

		    }
            addClick();
        </script>
		
	</div>
	<script type="text/javascript">
	    function zoom(size)
	    {
	        var content = document.getElementById("content");
	        content.style.fontSize = size+"px";
	        for(var i=0;i<content.childNodes.length;i++)
	        {
	            if(content.childNodes[i].nodeType==1)
	                content.childNodes[i].style.fontSize = size+"px";
	        }
	    }
	    
	    function quote(target,name)
	    {
	        var content = name+"："+target.parentNode.parentNode.parentNode.nextSibling.innerHTML;
	        var reply = document.getElementById("txtContent");
	        if (reply==null) return;
	        reply.value += "[quote]"+content.replace(/<br>/ig,'\n\r')+"[/quote]\n";
	        reply.focus();
	        
            var r = reply.createTextRange();
            r.moveStart('character',reply.innerHTML.length);
            r.collapse(true);
            r.select();
            
            //replace <fieldset(\S|\s)+?legend>(\S|\s)+</fieldset> to [quote]$2[/quote]
	    }
	</script>
 


        </div>
	</div>
	<div id="ctl00_panRight" class="siderRight column column3">
	
<div id="mod29" class="mod recommend">
    <h4 class="head">博文推荐</h4>
    <div class="cont">
	    <ul>
                    

	    </ul>
    </div>
</div>
<div id="mod30" class="mod comment">
    <h4 class="head">最新评论</h4>
    <div class="cont">
	    <ul>
		    

<li><a href="/jonllen/js/178.html#comment"><b>zlc</b>：你好，你https://github.com/lifesreason/SM2 这个库中除了一个test.html和test.aes-sm.html 的示例其他的 都没有 ，你方便挂上去吗？签名验签的这个我用https://www.npmjs.com/package/sm-crypto  这个库 后端无法签签，老的项目是用的你现在的这个库 可我并没有在你的例子中看到签名的方法，如果方便能提供一下嘛？</a></li>

<li><a href="/jonllen/js/178.html#comment"><b>5</b>：[quote]ywq：你好，能提供下js实现国密sm2加解密的下载链接吗?您提供的html里加载的js都是必须的吗[/quote]
</a></li>

<li><a href="/jonllen/js/178.html#comment"><b>5</b>：[quote]ywq：你好，能提供下js实现国密sm2加解密的下载链接吗?您提供的html里加载的js都是必须的吗[/quote]
</a></li>

<li><a href="/jonllen/work/162.html#comment"><b>hjc</b>：楼主能否发一份源码参考一下 感谢！邮箱地址18234105447@163.com</a></li>

<li><a href="/jonllen/work/162.html#comment"><b>hjc</b>：楼主能否发一份源码参考一下 感谢！</a></li>

	    </ul>
    </div>
</div>
 
<div id="mod31" class="mod recent">
    <h4 class="head">最近发表</h4>
    <div class="cont">
	    <ul>

                    
		    <li><a href="/jonllen/work/800.html">2015年度工作总结</a>(2015-12-31)</li>
                    
		    <li><a href="/jonllen/travel/801.html">靖港古镇游</a>(2015-11-29)</li>
                    
		    <li><a href="/jonllen/js/179.html">使用ECharts报表统计公司考勤加班，大家加班多吗？</a>(2015-06-05)</li>
                    
		    <li><a href="/jonllen/js/178.html">JavaScript实现SM2算法加解密</a>(2014-10-28)</li>
                    
		    <li><a href="/jonllen/breast/177.html">2014年国庆</a>(2014-10-04)</li>
                    
	    </ul>
    </div>
</div>
 
<div id="mod36" class="mod search">
	<h4 class="head">搜索</h4>
	<div class="cont">
		<form action="/search/" method="get">
	        <input type="text" name="key" class="text" value="" placeholder="输入搜索内容" />
	        <input type="submit" class="btn" value="搜索" />
	    </form>
	</div>
</div>
 
<div id="mod32" class="mod click">
    <h4 class="head">关注最多</h4>
    <div class="cont">
	    <ul>
                    
		    <li><a href="/jonllen/work/164.html">SM2非对称算法加解密</a>(35707)</li>
                    
		    <li><a href="/jonllen/aspnet/tinymce.html">TinyMce在线编辑器完美打造成Asp.Net服务器自定义控件</a>(32864)</li>
                    
		    <li><a href="/jonllen/work/162.html">国密算法SM2证书制作</a>(32559)</li>
                    
		    <li><a href="/jonllen/js/js-popup.html">摆脱JQuery—之自定义模拟弹窗层功能。</a>(26829)</li>
                    
		    <li><a href="/jonllen/aspnet/pd.html">使用PowerDesigner的物理模型创建升级管理数据库</a>(24306)</li>
                    
	    </ul>
    </div>
</div>
 
</div>
</div>

<div class="auto" id="foot">
    <div class="wrapper">
	Powered By ：Jonllen  <a href="http://www.miibeian.gov.cn" target="_blank">粤ICP备10049366号</a>
	</div>
</div>
 
<script type="text/javascript" src="/styles/index/scripts/Drag.js"></script>
<script type="text/javascript" src="/styles/index/scripts/Tooltip.js" ></script>
<div style="display:none"> 
    <script type="text/javascript" src="/styles/index/scripts/statistics.js"></script>
</div>
</body>
</html>